name: LNEngineWorkflow

on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - master

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Download Vulkan SDK
      run: |
        curl -LO https://sdk.lunarg.com/sdk/download/1.3.283.0/windows/VulkanSDK-1.3.283.0-Installer.exe
        Start-Process -Wait -NoNewWindow VulkanSDK-1.3.283.0-Installer.exe -ArgumentList '/S', '/D=C:\VulkanSDK\1.3.283.0'
      shell: pwsh

    - name: Set Vulkan SDK environment variable
      run: echo VULKAN_SDK=C:\VulkanSDK\1.3.283.0 | Out-File -FilePath $Env:GITHUB_ENV -Encoding utf8 -Append
      
    - name: Install Premake
      run: |
        choco install premake5

    - name: Build the project using Premake
      run: |
        call vendor\premake\Binaries\premake5.exe vs2022

    - name: Build solution with MSBuild
      run: |
        msbuild LNEngine.sln /p:Configuration=Debug

    - name: Build solution with MSBuild
      run: |
        msbuild LNEngine.sln /p:Configuration=Release

    - name: Build solution with MSBuild
      run: |
        msbuild LNEngine.sln /p:Configuration=Dist
